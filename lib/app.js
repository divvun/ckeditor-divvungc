"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var _get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===void 0){var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;return get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return call&&("object"==typeof call||"function"==typeof call)?call:self}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var debug="file:"===window.location.protocol,log=debug?console.log.bind(window.console):function(){},Inline=Quill.import("blots/inline");var ErrorBlot=function(_Inline){function ErrorBlot(){return _classCallCheck(this,ErrorBlot),_possibleConstructorReturn(this,(ErrorBlot.__proto__||Object.getPrototypeOf(ErrorBlot)).apply(this,arguments))}return _inherits(ErrorBlot,_Inline),_createClass(ErrorBlot,[{key:"showrep",value:function showrep(a,b){var c=$(this.domNode).offset(),d={top:c.top+20,left:c.left},f=$("#repmenu"),g=f.offset().top==d.top&&f.offset().left==d.left;f.is(":visible")&&g?hiderep():(f.show(),f.offset(d),!g&&this.makerepmenu(a,b))}},{key:"makerepmenu",value:function makerepmenu(a,b){var c=this.domNode,d=$(c).data("error");$("#repmenu_tbl").empty();var f=$(document.createElement("tbody"));f.attr("role","listbox"),""==d.msg&&(d.msg="Ukjend feiltype");var g=$(document.createElement("tr")),h=$(document.createElement("td")),j=$(document.createElement("span"));j.html(d.msg),j.attr("aria-disabled","true"),h.append(j),h.addClass("repmenu_msg"),g.append(h),f.append(g),d.rep.map(function(k){var l=$(document.createElement("tr")),m=$(document.createElement("td")),n=$(document.createElement("a"));""==k?n.text("(fjern)"):n.text(k.replace(/ /g,"\xA0")),(0==k.lastIndexOf(" ",0)||k.indexOf(" ",k.length-1)==k.length-1)&&n.addClass("hl-space"),n.attr("role","option"),m.append(n),m.addClass("repmenu_rep"),m.addClass("repmenu_nonfirst"),m.click({beg:a,len:b,r:k},replaceErr),l.append(m),f.append(l)}),$("#repmenu_tbl").append(f)}}],[{key:"create",value:function create(a){var b=_get(ErrorBlot.__proto__||Object.getPrototypeOf(ErrorBlot),"create",this).call(this);return"object"==("undefined"==typeof a?"undefined":_typeof(a))?($(b).data("error",a),$(b).addClass("class","error-blue"),b):(console.log("Error creating ErrorBlot, expected object, not "+("undefined"==typeof a?"undefined":_typeof(a))),_get(ErrorBlot.__proto__||Object.getPrototypeOf(ErrorBlot),"create",this).call(this))}},{key:"formats",value:function formats(a){return $(a).data("error")}}]),ErrorBlot}(Inline);ErrorBlot.blotName="error",ErrorBlot.tagName="span",ErrorBlot.className="error",Quill.register(ErrorBlot);var replaceErr=function replaceErr(a){hiderep();var b={ops:[{retain:a.data.beg},{delete:a.data.len},{insert:a.data.r}]};quill.updateContents(b,"user"),atMostOneSpace(a.data.beg),checkOnIdle(2000),quill.focus()},hiderep=function hiderep(){var a=$("#repmenu");a.offset({top:0,left:0}),a.hide()},onSelectionChange=function onSelectionChange(a,b,c){if(null!=a&&0===a.length&&"user"===c){var d=quill.scroll.descendant(ErrorBlot,a.index),f=d[0],g=d[1];if(null!=f)if($(f.domNode).data("error")){var h=a.index-g,j=f.length();f.showrep(h,j)}else console.log("descendant ErrorBlot at",a.index,"had no data, clearing markup"),quill.formatText(a.index-g,f.length(),"error",!1)}},atMostOneSpace=function atMostOneSpace(a){for(var b=getFText();" "==b[a-1];)a--;for(var c=0;" "==b[a+c];)c++;1<c&&quill.deleteText(a,c-1,"user")},clearErrs=function clearErrs(){quill.formatText(0,quill.getLength(),"error",!1)},applyErrs=function applyErrs(a,b){b.errs.forEach(function(c){var d=c[2]-c[1];log(c),quill.formatText(c[1],d,"error",{str:c[0],beg:c[1],end:c[2],len:d,typ:c[3],rep:c[5],msg:c[4]})}),log(b)},toolbarOptions=[[{header:[1,2,3,!1]}],["bold","italic","underline"],["link"],[{list:"ordered"},{list:"bullet"}],["clean"],["check"]],quill=new Quill("#editor",{modules:{toolbar:{container:toolbarOptions,handlers:{check:function check(a){_check()}}}},theme:"snow",placeholder:"\u010C\xE1lis d\xE1sa, dahje v\xE1lljes ovdmearkka d\xE1s vuol\xE1bealde"}),getFText=function getFText(){return quill.getContents().ops.map(function(a){return"string"==typeof a.insert?a.insert:" "}).join("")},examples=[{title:"Goalloss\xE1tnemeatt\xE1husat",delta:{ops:[{insert:"Bealljeheamit leat, nu movt Norgga Bealljehemiidlihttu oaidn\xE1, duvdojuvvon olggobeallai diehtojuohkinservodaga, miidagaha ahte bealljeheamit d\xE1vj\xE1 o\u017E\u017Eot unnit die\u0111uid servodat dil\xE1la\u0161vuo\u0111ain.\n\n"},{insert:"Son j\xE1hkii b\xE1rtniid liikot buorebut \u010Duvges-vuovttat nieiddaide.\n\n"},{insert:"Otne leat sihke neahtta-b\xE1lvalusat ja mobiila atnu progr\xE1mmat buotl\xE1gan die\u0111uid nugomat d\xE1lkedie\u0111uid ja girdi\xE1iggiid ja busseruvttuid ja gos lagamus fal\xE1stallanrusttet lea.\n\n"},{insert:"Mannan vuoss\xE1rga lei illu beaivi K\xE1r\xE1\u0161joga MNP-beara\u0161ossodahkii.\n\n"},{insert:"Dat lea illu s\xE1hka midjiide , go juovlam\xE1nus bargguhisvuohta Finnm\xE1rkkus lea 3,1 proseantta.\n\n"},{insert:"Muhto dattege, vaikke vel d\xE1t die\u0111usge lea illu diehtu sidjiide geat bero\u0161tit s\xE1megielat girjiin , de bo\u0111ii gielddastivrra mearr\xE1dus gieskat veah\xE1 \xE1rtegis vuogi mielde.\n\n"},{insert:"Mis ii g\xE1vdnon s\xE1tni , mii devddii dan illu d\xE1hp\xE1husa.\n\n"},{insert:"Njulge k\xE1rta dakk\xE1r sadj\xE1i gokko lea jalgat Bonja k\xE1rtta nu ahte davvi guovlu k\xE1rttas ja komp\xE1ssa davvi guovlu heiveba oktii Bija komp\xE1ssaduolbba ravdda nu ahte mann\xE1 dan b\xE1ikkis gos leat d\xE1l, dohkko gosa \xE1iggut Bonja komp\xE1ssajorbb\xE1 nu ahte s\xE1zut jorbb\xE1s \u0161addet d\xE1ss\xE1laga davvis\xE1zuiguin k\xE1rttas Heivet komp\xE1ssa davvinjuola, g\xE1hta sisa Mannannjuolla \u010D\xE1jeha gosa galggat mannat\n\n"}]}},{title:"\u010C\xE1llinmeatt\xE1husat (njuolga h\xE1pmi vearrokonteavsttas)",delta:{ops:[{insert:"Du\u0161\u0161e \u010Dohkka ja juga g\xE1fe. Sin m\xE1ksu han lei varra seamm\xE1 ollu maidd\xE1i sihke.\n\n"},{insert:"Guttorm Utsi ball\xE1 s\xE1kka \xE1rbevirola\u0161 s\xE1mi duodji s\xE1htt\xE1 j\xE1vkat 10 jagi geah\u010Des Deanus jos dasa ii dahkkut miige.\n\n"},{insert:" Luohtti f\xE1moleabbo go leat m\xE1\u014Bggas.\n\n"},{insert:" Earenoam\xE1\u017Eit jus ii luohte eannet ie\u017Eat intui\u0161uvdnii ja jierpm\xE1la\u0161vuhtii, de mann\xE1 duinna hui bures.\n\n"},{insert:" Ja biso\u0161ii hal doppe nuppiin bie\u0111agiin ovttas ovtta gaskka \u2013 de liv\u010D\u010Dii r\xE1fi ajihustit go d\xE1l ii leat \u010Divga ge bo\u014Bkime, dat lea vi\u017E\u017Eojuvvon g\xE1vpogii eatnis olbmuid lusa ja galg\xE1 orrut muo\u0167\u0167\xE1s luhtte gitta go eatnis varrostuvv\xE1.\n\n"},{insert:"Ulbmil lea movttiidahttit lohkamii ja oa\u017E\u017Eut eambbosiid liikot girjiide.\n\n"},{insert:"Don fal muitt\xE1t man ollu \u010Duoikkat diibm\xE1 ledje, ii ballen baljo jaska \u010Dohkkat.\n\n"},{insert:"\u2013 Moai Aleftina Serginain letne guhkit \xE1iggi \u010Dohken  die\u0111uid \xC1hkkila s\xE1miid birra ja d\xE1l lea munno girjii v\xE1lmmas, \u010Dilge Leif Rantala.\n\n"}]}},{title:"D\xE1rom\xE1llegat",delta:{ops:[{insert:"osv.\n\n"}]}},{title:"\u010Cuokkesmeatt\xE1husat",delta:{ops:[{insert:"\"nu - nu\"\n\n"}]}},{title:"Kongrueansameatt\xE1husat",delta:{ops:[{insert:"R\xE1\u0111\u0111eolmm\xE1i jearai jos poasta ii lean bero\u0161tan o\u0111\u0111a die\u0111uid mat ledjet boaht\xE1n \xE1\u0161\u0161is.\n\n"},{insert:"Go Davvin\xE1sti ollii 1796 Bergenii, ledje das mielde 2000 viegu goikeguolli.\n\n"}]}},{title:"Valeansameatt\xE1husat",delta:{ops:[{insert:"Dasto jearaimet bero\u0161tit go oahppat s\xE1megiela buorebut, ja jos nu, de man suorggis ja mo h\xE1liidit oahppat.\n\n"},{insert:"M\xE1\u014Bggas ballet \u010Dohkk\xE1t busses, eandalii unnit m\xE1n\xE1t eai \xE1iggo busse mielde, lohk\xE1 rektor.\n\n"},{insert:"Dasto jearaimet bero\u0161tit go oahppat s\xE1megiela buorebut, ja jos nu, de man suorggis ja mo h\xE1liidit oahppat.\n\n"}]}},{title:"K\xE1susmeatt\xE1husat",delta:{ops:[{insert:"Muhto mon liikon nieiddade. R\xE1\u0111\u0111eolmm\xE1i jearai jos poasta ii lean bero\u0161tan o\u0111\u0111a die\u0111uid mat ledjet boaht\xE1n \xE1\u0161\u0161is.\n\n"},{insert:"Liikon hirbmadit 1920- logu, ja lean lohkan girjii ja filmma The Great Gatsby, danin \u0161attai Gatsby, muitala Ann.\n\n"},{insert:"Viid\xE1set atnu EO lea mero\u0161tallan ahte EO ja Norgga almmola\u0161 die\u0111uid m\xE1rkan\xE1rvu lea sullii 200 milj\xE1rdda ruvdno.\n\n"},{insert:"Doppe lei stuorra gor\u017Ei, mii lei 15 mehter alo, gos mii njuikkodeimmet liegga sevdjnes eahkediin.\n\n"}]}},{title:"Biehttalanh\xE1pmemeatt\xE1husat",delta:{ops:[{insert:"Nu s\xE1htt\xE1 interneahtta \u0161addat s\xE1mi m\xE1n\xE1ide ja nuoraide oahpasnuvvan, g\xE1vnnadan, ja oahppogazzanb\xE1ikin, ja dan vel eambbo go juo d\xE1ss\xE1 ii lea leama\u0161an.\n\n"}]}},{title:"Leksik\xE1la meatt\xE1husat",delta:{ops:[{insert:"Vaikko diein leat vallji bohccot. Vaikko diein leat valjit bohccot.\n\n"}]}},{title:"Adjektiivah\xE1pmemeatt\xE1husat",delta:{ops:[{insert:"Eall\xE1mu\u0161vallji eanan \u0161add\xE1 go gehppesmoll\xE1neaddji b\xE1kte\u0161l\xE1jat, \xE1baida k\xE1lkavallji \u0161l\xE1jat, v\xE1ikkuhuvvojit ja nu h\xE1ddjanit (golladuvvojit).\n\n"},{insert:"Su musihkka lea poehtala\u0161 ja das lea roavis ja ih\xE1na \u010D\xE1ppa ja fiinna.\n\n"}]}}],searchToObject=function searchToObject(){var a=window.location.search.substring(1).split("&"),b={};for(var c in a)if(-1<a[c].indexOf("=")){var d=a[c].split("="),f=d[0],g=d[1].replace(/\+/g,"%20");b[decodeURIComponent(f)]=decodeURIComponent(g)}return b},port="file:"===window.location.protocol?"2737":"2737",hostname=""===window.location.hostname?"localhost":window.location.hostname,protocol="file:"===window.location.protocol?"http:":window.location.protocol,checkUrl=protocol+"//"+hostname+":"+port.toString()+"/translateRaw";log(checkUrl);var userLang=function userLang(){return"sme"},hideLogin=function hideLogin(){$("#serverfault").hide(),$("#loginform").hide(),$("#content").removeClass("blur"),$("#login-wrapper").removeClass("block-view"),$("#logout").show()},showLogin=function showLogin(){$("#loginform").show(),$("#content").addClass("blur"),$("#login-wrapper").addClass("block-view"),$("#logout").hide()};function utoa(a){return btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(b,c){return String.fromCharCode("0x"+c)}))}var basicAuthHeader=function basicAuthHeader(a){return null==a?($("#serverfault").html("\u010C\xE1llet go beassans\xE1ni boastut?"),$("#serverfault").show(),showLogin(),"Basic TODO"):"Basic "+utoa(a.u+":"+a.p)},checkXHR=null,servercheck=function servercheck(a,b,c){log("servercheck:"),null!=checkXHR&&checkXHR.abort(),checkXHR=$.ajax({beforeSend:function beforeSend(d){d.setRequestHeader("Authorization",basicAuthHeader(a))},type:"POST",url:checkUrl,data:{langpair:"sme|sme_gram",q:b},success:function success(d){c(b,d)},error:function error(d,f,g){console.log("error: "+f+"\n"+g),console.log(d),console.log(d.status),"abort"===f&&0===d.status||("error"===f&&0===d.status?($("#serverfault").html("B\xE1lv\xE1 ii oro doaibmamin, dahje don it leat neahtas. Geah\u010D\u010Dal vie\u017E\u017Eat siiddu o\u0111\u0111asit."),$("#serverfault").show()):($("#serverfault").html("\u010C\xE1llet go geavaheaddjinama/beassans\xE1ni boastut? Oa\u010D\u010Dui meatt\xE1huskoda "+d.status+" "+g+"/"+f+" st\xE1htusiin."),$("#serverfault").show(),showLogin()))},dataType:"json"})},_check=function _check(){clearErrs();var a=getFText();window.localStorage.text=JSON.stringify(quill.getContents());var b=safeGetItem("userpass",readLoginFormStoring());null==b?showLogin():servercheck(b,a,applyErrs)},readLoginFormStoring=function readLoginFormStoring(){var a={u:$("#user").val(),p:$("#password").val()};return""!=a.u&&""!=a.p?(window.localStorage.setItem("userpass",JSON.stringify(a)),a):null},loginFromForm=function loginFromForm(){var a=readLoginFormStoring();return null!=a&&hideLogin(),!1},loginOnEnter=function loginOnEnter(a){13==a.which&&loginFromForm()},loginOnClick=function loginOnClick(a){return loginFromForm(),!1},idleTimer=null,checkOnIdle=function checkOnIdle(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3000;window.clearTimeout(idleTimer),idleTimer=window.setTimeout(_check,a)},onTextChange=function onTextChange(a,b,c){"api"==c||"user"==c&&(hiderep(),checkOnIdle())},logout=function logout(a){return showLogin(),window.localStorage.removeItem("userpass"),$("#user").val(""),$("#password").val(""),!1},initSpinner=function initSpinner(){$("#spinner").hide(),$("#editor").removeClass("loading"),$(document).ajaxStart(function(){$("#spinner").show(),$("#editor").addClass("loading"),$(".ql-check").addClass("glyphicon glyphicon-refresh spinning"),$(".ql-check").addClass("loading-check")}).ajaxStop(function(){$("#spinner").hide(),$("#editor").removeClass("loading"),$(".ql-check").removeClass("glyphicon glyphicon-refresh spinning"),$(".ql-check").removeClass("loading-check")})},safeGetItem=function safeGetItem(a,b){var c=window.localStorage.getItem(a);if(null==c)return b;try{var d=JSON.parse(c);if(null!=d)return d}catch(f){console.log(f)}return b},init=function init(){"http:"==window.location.protocol&&$("#password").attr("type","text"),$("#login_b").click(loginOnClick),$("#password").keypress(loginOnEnter),$("#user").keypress(loginOnEnter),$("#logout_b").click(logout),$("#editor").click(hiderep),$("body").click(hiderep),initSpinner(),$("#examples-wrapper h4").text("Ovdamearkkat:"),examples.map(function(c){var d=$(document.createElement("button"));d.text(c.title),d.attr("type","button"),d.addClass("btn btn-default"),$(d).click(function(){quill.setContents(c.delta),_check()}),$("#examples").append(d),$("#examples").append(" ")}),$.ajaxSetup({statusCode:{"401":function _(){showLogin()}}}),quill.on("text-change",onTextChange),quill.on("selection-change",onSelectionChange);var a=searchToObject(),b={ops:[]};a.q==void 0?b=safeGetItem("text",b):(b={ops:[{insert:a.q}]},window.location.search=""),quill.setContents(b),clearErrs(),hiderep(),_check()};$(document).ready(init);
//# sourceMappingURL=app.js.map